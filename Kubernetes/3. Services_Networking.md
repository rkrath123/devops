Services
==========

![image](https://user-images.githubusercontent.com/53966749/200308850-fdfca5f7-6660-4633-a1bb-dacdfb0674f3.png)
![image](https://user-images.githubusercontent.com/53966749/200308897-87a9d5ad-d37f-4424-9f8b-8d123aed4736.png)


cluster ip
===========
![image](https://user-images.githubusercontent.com/53966749/200310656-64f15e61-0e78-4a60-8333-d08907ece15f.png)

```
sles15sp3:~/test # kubectl create deployment --image=nginx my-nginx --replicas=3 --port=80
deployment.apps/my-nginx created

sles15sp3:~/test # kubectl get pods --show-labels
NAME                       READY   STATUS    RESTARTS   AGE     LABELS
my-nginx-ddc8f96f8-hrzns   1/1     Running   0          6m38s   app=my-nginx,pod-template-hash=ddc8f96f8
my-nginx-ddc8f96f8-j8hcj   1/1     Running   0          6m38s   app=my-nginx,pod-template-hash=ddc8f96f8
my-nginx-ddc8f96f8-sqw9m   1/1     Running   0          6m38s   app=my-nginx,pod-template-hash=ddc8f96f8

sles15sp3:~/test # cat service-selector.yaml
apiVersion: v1
kind: Service
metadata:
   name: kplabs-service-selector
spec:
   selector:
     app: my-nginx
   ports:
   - port: 80
     targetPort: 80
sles15sp3:~/test # kubectl apply -f service-selector.yaml
service/kplabs-service-selector created

sles15sp3:~/test # kubectl get service
NAME                      TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
kplabs-service-selector   ClusterIP   10.12.5.70   <none>        80/TCP    36s
kubernetes                ClusterIP   10.12.0.1    <none>        443/TCP   25d
sles15sp3:~/test # kubectl describe service kplabs-service-selector
Name:              kplabs-service-selector
Namespace:         default
Labels:            <none>
Annotations:       cloud.google.com/neg: {"ingress":true}
Selector:          app=my-nginx
Type:              ClusterIP
IP Family Policy:  SingleStack
IP Families:       IPv4
IP:                10.12.5.70
IPs:               10.12.5.70
Port:              <unset>  80/TCP
TargetPort:        80/TCP
Endpoints:         10.8.1.7:80,10.8.2.22:80,10.8.3.16:80
Session Affinity:  None
Events:            <none>


sles15sp3:~/test # kubectl get pods -o wide
NAME                       READY   STATUS    RESTARTS   AGE   IP          NODE                                       NOMINATED NODE   READINESS GATES
my-nginx-ddc8f96f8-hrzns   1/1     Running   0          11m   10.8.2.22   gke-cluster-1-default-pool-37115ec3-csyj   <none>           <none>
my-nginx-ddc8f96f8-j8hcj   1/1     Running   0          11m   10.8.1.7    gke-cluster-1-default-pool-37115ec3-ngw4   <none>           <none>
my-nginx-ddc8f96f8-sqw9m   1/1     Running   0          11m   10.8.3.16   gke-cluster-1-default-pool-37115ec3-beno   <none>           <none>


sles15sp3:~/test # kubectl exec -it my-nginx-ddc8f96f8-hrzns -- bash
root@my-nginx-ddc8f96f8-hrzns:/# curl 10.12.5.70
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>

root@my-nginx-ddc8f96f8-hrzns:/# curl 10.8.2.22:80
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
```

Port vs target port
====================
![image](https://user-images.githubusercontent.com/53966749/200314142-5a120c38-3791-4930-9571-059ce1f6920f.png)

```
sles15sp3:~/test # kubectl create deployment --image=nginx my-nginx --replicas=2
deployment.apps/my-nginx created
sles15sp3:~/test #
sles15sp3:~/test # kubectl expose deployment my-nginx --port=8080 --target-port=80
service/my-nginx exposed
sles15sp3:~/test #
sles15sp3:~/test # kubectl get svc
NAME         TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)    AGE
kubernetes   ClusterIP   10.12.0.1     <none>        443/TCP    25d
my-nginx     ClusterIP   10.12.3.144   <none>        8080/TCP   7s
sles15sp3:~/test #
sles15sp3:~/test # kubectl get ep
NAME         ENDPOINTS                   AGE
kubernetes   34.123.239.57:443           25d
my-nginx     10.8.1.15:80,10.8.2.31:80   14s
sles15sp3:~/test #
sles15sp3:~/test # kubectl get pods -o wide
NAME                       READY   STATUS    RESTARTS   AGE   IP          NODE                                       NOMINATED NODE   READINESS GATES
my-nginx-c54945c55-4r4pn   1/1     Running   0          45s   10.8.2.31   gke-cluster-1-default-pool-37115ec3-csyj   <none>           <none>
my-nginx-c54945c55-ncr9q   1/1     Running   0          45s   10.8.1.15   gke-cluster-1-default-pool-37115ec3-ngw4   <none>           <none>
webserver                  1/1     Running   0          15m   10.8.3.25   gke-cluster-1-default-pool-37115ec3-beno   <none>           <none>
sles15sp3:~/test # kubectl run -it --rm --image=curlimages/curl curly -- sh
If you don't see a command prompt, try pressing enter.
/ $
/ $ curl 10.8.1.15:80
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>

/ $ curl 10.12.3.144:8080
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>

/ $ curl 10.8.2.31:80
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
```

 Deployments and service Manifest file 
 --------------------------------------
 ```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.14.2
        ports:
        - containerPort: 80
        
kubectl apply -f demo-deployment.yaml

Creating Service
-----------------
apiVersion: v1
kind: Service
metadata:
   name: kplabs-service-selector
spec:
   selector:
     app: nginx
   ports:
   - port: 80
     targetPort: 80
     
 kubectl apply -f service-selector.yaml

```
NodePort
========
![image](https://user-images.githubusercontent.com/53966749/200329951-eff3bb84-ce18-4001-8d6d-1f4014823d7c.png)

